root = exports ? this

root.guide = [
    {
        "category": "דרכי התקשרות עם הרשות המקומית וראש הרשות", 
        "fields": [
            "הכתובת הפיזית של משרדי הרשות", 
            "מספרי טלפון (מרכזיית הרשות/שלוחות)", 
            "אימייל כללי לרשות/ טופס פניה מקוון", 
            "שם ראש הרשות", 
            "מספר טלפון של ראש הרשות", 
            "אימייל/ טופס מקוון ליצירת קשר עם ראש הרשות"
        ]
    }, 
    {
        "category": "דרכי התקשרות עם האגף והמחלקה", 
        "fields": [
            "קיים מוקד עירוני באתר הרשות", 
            "במוקד העירוני יש אפשרות מעקב אחר הטיפול בפניות", 
            "שם מנהל/ת האגף", 
            "רמת האגף: טלפון", 
            "רמת האגף: אימייל/טופס מקוון/צור קשר", 
            "כתובת פיזית של האגף", 
            "שעות קבלת קהל באגף", 
            "שם מנהל/ת המחלקה (בהנחה ששמות המחלקות קיימים)", 
            "רמת המחלקה: טלפון"
        ]
    }, 
    {
        "category": "דרכי התקשרות עם חברי מועצה", 
        "fields": [
            "רשימה של חברי מועצה", 
            "מופיעה רשימה של סמכויותיהם של חברי המועצה(לדוגמה, נושא תיק התחדשות עירונית, או חבר/ה בוועדה עירונית מסוימת)", 
            "לכל חבר/ת מועצה מצוין אימייל/טופס מקוון", 
            "מצוין מספר טלפון נייח", 
            "יש/אין פורומים", 
            "כן/לא נוכחות בפייסבוק / טוויטר ועוד"
        ]
    }, 
    {
        "category": "מבקר העירייה", 
        "fields": [
            "פרסום הדו\"ח השנתי האחרון (2011) של מבקר הרשות", 
            "פרסום דו\"חות השנתיים הקודמות (2009-2010) של מבקר הרשות", 
            "פרסום פרטי קשר של מבקר הרשות, ודרכי הפנייה אליו"
        ]
    }, 
    {
        "category": "שקיפות: לפי חוק חופש המידע", 
        "fields": [
            "פרסום הדו\"ח השנתי האחרון (2011)", 
            "פרסום דו\"חות השנתיים הקודמות (2010-2009)", 
            "המבנה הארגוני מוצג באתר", 
            "פרסום חוק חופש המידע", 
            "פרסום שם הממונה על חופש המידע", 
            "אימייל אישי/טופס פנייה מקוון לממונה", 
            "מספר הטלפון במשרד הממונה"
        ]
    }, 
    {
        "category": "פניות הציבור", 
        "fields": [
            "פרסום שם הממונה על פניות/תלונות הציבור", 
            "אימייל אישי/טופס פנייה מקוון לממונה", 
            "מספר הטלפון במשרד הממונה"
        ]
    }, 
    {
        "category": "שקיפות: נדרש ע\"פ חוק חופש המידע", 
        "fields": [
            "רשימת מאגרי מידע", 
            "פרסום מאגרי מידע באתר", 
            "פרטי קשר למנהל/ת מאגר המידע", 
            "סקירת עיקרי פעולות הרשות המתוכננות לשנה הנוכחית (2012)", 
            "פרסום חוקי עזר עירוניים (מספיק אם יש קישור)"
        ]
    }, 
    {
        "category": "מענקים ותמיכות", 
        "fields": [
            "רשימת קרנות ומלגות שבמימון הרשות הציבורית (ע\"פ חוק חופש המידע)", 
            "קריטריונים למתן קרנות ומלגות שבמימון הרשות הציבורית (תוספת – המידע אינו נדרש ע\"פ חוק חופש המידע)", 
            "רשימת תמיכות וחסויות שנתנה הרשות הציבורית בשנה החולפת (ע\"פ חוק חופש המידע)", 
            "קריטריונים למתן תמיכות וחסויות (תוספת – המידע אינו נדרש ע\"פ חוק חופש המידע)", 
            "רשימת מוסדות הציבור שזכו לתמיכה בשנה החולפת", 
            "היקף התמיכה במוסדות הציבור", 
            "ניתן להגיש בקשה למענק באמצעות אתר האינטרנט", 
            "הקצאת מבני ציבור", 
            "שינוי ייעוד של מבני ציבור", 
            "פרסום מידע בנוגע להקצאת קרקע כתמיכה למטרות ציבוריות", 
            "פרסום הקריטריונים לזכייה", 
            "פרסום שמות המבקשים", 
            "פרסום שמות הזוכים", 
            "פרסום מוקדם של סדר יום של ועדת מענקים תמיכות", 
            "פרסום של הפרוטוקולים של דיוני ועדת מענקים ותמיכות"
        ]
    }, 
    {
        "category": "שקיפות: לא נדרש ע\"פ החוק", 
        "fields": [
            "פרסום קוד אתי", 
            "פרסום טפסים לגבי ניגודי עניינים של נבחרי ציבור ובכירים (לדוגמה, ראש הרשות וסגניו, חברי מועצה, מנכ\"ל והנהלה בכירה)", 
            "פרסום הסכמים קואליציוניים", 
            "מידע סטטיסטי: פרסום המידע הסטטיסטי המופק ברשות המקומית (דמוגרפיה/חינוך; ללא קשר למאגרי המידע)", 
            "מידע סטטיסטי: פרסום המידע הנ\"ל תוך התייחסות בעיבוד הנתונים להשלכות מגדריות; בעקבות תיקון חקיקה"
        ]
    }, 
    {
        "category": "ישיבות מועצה", 
        "fields": [
            "פרסום מועדי הישיבות ומיקומן", 
            "האם קיימת הזמנה/עידוד/קריאה לתושבים להשתתף בדיון", 
            "פרסום מסמכים וטיוטות הקשורים לישיבות הקרובות", 
            "ישיבות: מוצג מראש סדר היום (לא בפרוטוקול)", 
            "פרוטוקולים: גם בווידיאו ואודיו (לציין אם נמצאו פרוטוקולים באודיו בלבד)"
        ]
    }, 
    {
        "category": "כספים: תקציב – לפי חוק חופש המידע", 
        "fields": [
            "פרסום התקציב לשנה הנוכחית (2012)", 
            "פרסום תקציר המספק את עיקרי המידע, כולל סכומים", 
            "פרסום תקציב השנתיים הקודמות (לפי החוק: רק לשנה החולפת)", 
            "פירוט הוצאות הרשות הציבורית בשנה החולפת, לפי סעיפי התקציב", 
            "פרסום תכנון לעומת ביצוע (מקורות כספיים ושימושים לכל מחלקה)"
        ]
    }, 
    {
        "category": "כספים: תקציב – המידע אינו נדרש לפי חוק חופש המידע", 
        "fields": [
            "ריכוז מידע על סעיפי ההכנסות הגבוהים ביותר (תקבולים, זיכיונות) – כולל הסברים", 
            "ריכוז מידע על סעיפי ההוצאות הגבוהים ביותר (ספקים, דלק לסוגיו, השימוש בכלי רכב של הרשות) – כולל הסברים", 
            "פרסום חמשת מקבלי השכר הגבוה ברשות לפי תפקידים בלבד (ללא שמות)", 
            "פרסום הדו\"חות הכספיים של הרשות לשנה החולפת (2011: מאזן + דו\"ח רווח והפסד)", 
            "פרסום הדו\"חות הכספיים בשנתיים הקודמות (2009-2010)", 
            "פרסום מוקדם של סדר היום, והפרוטוקולים של דיוני התקציב בוועדת הכספים"
        ]
    }, 
    {
        "category": "כספים: ארנונה", 
        "fields": [
            "תעריפי ארנונה (פרטית, עסקית, ציבורית)", 
            "קריטריונים להנחות ופטורים בארנונה"
        ]
    }, 
    {
        "category": "חוזים ומכרזים: תשתית", 
        "fields": [
            "פרסום המכרזים באתר", 
            "פרסום קריטריונים במכרז והמשקל לכל קריטריון", 
            "האם העירייה אימצה מסמך מדיניות נגד שחיתות במכרזים", 
            "פרסום תכנון שנתי של תכניות הרכש", 
            "פרסום פרוטוקולים של ועדת הפטורים ו/או החלטות ונימוקים (פטור ממכרז ו/או הכרזה על ספק יחיד)", 
            "פרסום תוצאות המכרזים באתר העירייה (בנפרד מפרוטוקול הוועדה)", 
            "יש RSS (הודעות ע\"י אמייל/לנייד על עדכון באתר)", 
            "פרסום מתן זיכיונות על ידי העירייה"
        ]
    }, 
    {
        "category": "חוזים ומכרזים: כוח אדם", 
        "fields": [
            "פרסום המכרזים באתר", 
            "פרסום קריטריונים במכרז והמשקל לכל קריטריון", 
            "פרסום קריטריונים לקבלת עובד/ת שלא במסגרת מכרז"
        ]
    }, 
    {
        "category": "רישוי עסקים", 
        "fields": [
            "פרסום מידע על התנאים למתן רישיון עסק ותהליך הרישוי למבקשי הרישיון", 
            "פרסום מידע לציבור על הבקשות לרישוי עסקים (במיוחד באזורים שיש בהם תמהיל של מסחר ומגורים)"
        ]
    }, 
    {
        "category": "תכנון ובנייה", 
        "fields": [
            "פרסום תכניות הבנייה לאנשי מקצוע (ארכיטקטים, עורכי דין)", 
            "פרסום תכניות הבנייה בשפה ברורה ובאופן המאפשר התמצאות קלה (לדוגמה, אפשרות חיפוש/סינון ע\"פ מיקום, ע\"פ ועדות, ע\"פ לו\"ז וכד'. אפשר לתאר את המידע הקיים)", 
            "מידע קונקרטי לתושב בנושאי רישוי ופיקוח והיתרי בנייה (התהליך לאישור סגירת מרפסת)", 
            "פרסום הנוהל לשינוי ייעוד של מבני ציבור", 
            "פרסום הצעות/ מועמדים לפני שינוי ייעוד של מבני ציבור", 
            "פרסום החלטות ונימוקים לגבי שינוי ייעוד של מבני ציבור", 
            "העלאת טיוטות של תוכניות תכנון ובנייה לדיון ציבורי (לציין אם התוכניות כוללות שינוי ייעודי קרקע)", 
            "מערכת GIS (הצגת נתונים על גבי מפה) כוללת מידע על ייעודי קרקע."
        ]
    }, 
    {
        "category": "תכנון וסביבה: לפי חוק חופש המידע (סכימת ממצאים לכלל סוגי הזיהום; פירוט בטבלה)", 
        "fields": [
            "זהות המקור לפליטת הזיהום (חומרים לסביבה או לרעש, ריח או קרינה) שלא ברשות היחיד", 
            "שם החומר או קבוצת חומרים הנפלטים לסביבה, כמותם וריכוזם", 
            "הסוג והרמה של הרעש הריח והקרינה הנמדדים בסביבה", 
            "מיקום מועד ושיטת איסוף המידע וכן הגורם שאסף את המידע בעבור הרשות", 
            "אזור גיאוגרפי ומועד פליטת החומר לסביבה ויצירת הרעש, הריח החומר או הקרינה", 
            "האם החומר נפלט אל האוויר, הים, הקרקע או המים", 
            "המידע הסביבתי מוצג בליווי ביאורים והקשרים, וכולל מידע מעובד כמו דו\"חות תקופתיים"
        ]
    }, 
    {
        "category": "תכנון וסביבה: המידע אינו נדרש לפי חוק חופש המידע", 
        "fields": [
            "המידע הסביבתי כולל הסבר על ההשלכות הבריאותיות והסביבתיות של סוגי הזיהום השונים", 
            "המידע הסביבתי ברור וגלוי. לתאר את אופני הצגתו: דיווח טכני בלבד/ שורה תחתונה/ מפה/ מגמות", 
            "לציין אם, בנוסף למידע מעובד, יש גישה למאגר הנתונים (המאפשר, לדוגמה, השוואות לאורך זמן, בין רשויות, בין שכונות וכד')", 
            "האם יש פרסום של תהליכי קבלת החלטות בתחום איכות סביבה (בנוסף לבדיקת ועדת איכות הסביבה כחלק מבדיקת הוועדות לעיל)", 
            "האם יש פרסום קריטריונים לזיהום סביבתי, או קישור לחקיקה הארצית בנושא", 
            "האם קיים פרסום מדידת זיהום אויר, בתדירות גבוהה", 
            "האם יש פרסום של מיקום פחי מחזור, מכל הסוגים: נייר, רטוב, פלסטיק, זכוכית, סוללות, מצברים, שמנים", 
            "האם יש פרסום של מיקום קומפוסטרים, אתרי מחזור לפסולת", 
            "האם יש מידע על נוהל פינוי במקרה שלתושב אין יכולת לפנות בעצמו", 
            "האם יש פרסום של מספר גנים ציבוריים ביחס לשטח העיר", 
            "האם יש פרסום לגבי מיקום למסירת בגדי יד שנייה", 
            "לפרט האם קיימים מסמכים בנושאים: זיהום אוויר, מים, אנרגיה, והתייעלות אנרגטית (UN) (טווח הציונים: 0-3)  האנרגיה. יש קידום של נושא הפרדת האשפה הביתית וקריאה להצטרפות לשולחן עגול בהשתתפות התושבים לדיון על הפרויקט. יש פרויקט של נטיעות עצים http://www.ashdod.muni.il/RESIDENTSERVICE/NETIOT/Pages/default.aspx ותכנית ל\"עיר ירוקה\".", 
            "פרסום תוכניות קיימות ומדיניות פיתוח (בנייה/סביבה)"
        ]
    }, 
    {
        "category": "חברות עירוניות", 
        "fields": [
            "פרסום רשימת החברות העירוניות", 
            "פרסום רשימת חברי הדירקטוריון של כל החברות העירוניות (כולל חברי מועצה ונציגי ציבור)", 
            "קישור לאתר החברות שבבעלות העירייה, כולל בעלות חלקית, או תת-אתר באתר העירוני עבורן", 
            "דו\"חות שנתיים של החברות העירוניות"
        ]
    }
]

root.data = [
    {
        "website": "http://www.tel-aviv.gov.il/Hebrew/Index.asp", 
        "data": [
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                1.0, 
                1.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.5, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                1.0, 
                1.0, 
                0.5
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.5
            ], 
            [
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                0.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                0.5, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0
            ]
        ], 
        "name": "תל אביב-יפו", 
        "coordinates": [
            34.777821, 
            32.066157
        ], 
        "id": 3
    }, 
    {
        "website": "http://www.jerusalem.muni.il/jer_main/defaultnew.asp?lng=1", 
        "data": [
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                1.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                0.0, 
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5
            ], 
            [
                0.5, 
                1.0, 
                0.5, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.5, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                0.0
            ]
        ], 
        "name": "ירושלים", 
        "coordinates": [
            35.213711, 
            31.768318
        ], 
        "id": 2
    }, 
    {
        "website": "http://www.holon.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                0.5, 
                0.5, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                1.0, 
                0.0
            ], 
            [
                0.5, 
                0.5, 
                0.0, 
                1.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                0.5, 
                1.0, 
                0.5, 
                0.5
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                0.0, 
                1.0, 
                1.0, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.5, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                0.0
            ]
        ], 
        "name": "חולון", 
        "coordinates": [
            34.787386, 
            32.015832
        ], 
        "id": 1
    }, 
    {
        "website": "http://www.rishonlezion.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.5, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                0.5
            ], 
            [
                0.5, 
                0.0, 
                0.5, 
                1.0, 
                0.0
            ], 
            [
                0.5, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5
            ], 
            [
                0.5, 
                0.5, 
                0.5, 
                0.0, 
                1.0, 
                1.0, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                0.0
            ]
        ], 
        "name": "ראשון לציון", 
        "coordinates": [
            34.80705, 
            31.961544
        ], 
        "id": 7
    }, 
    {
        "website": "http://www.haifa.muni.il/haifa/Pages/haifa.aspx", 
        "data": [
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                0.5, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.5, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.5, 
                0.5, 
                0.0, 
                0.5, 
                0.5, 
                0.5, 
                0.5
            ], 
            [
                0.5, 
                0.5, 
                0.5, 
                1.0, 
                1.0, 
                1.0, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                0.5
            ]
        ], 
        "name": "חיפה", 
        "coordinates": [
            34.974339, 
            32.83036
        ], 
        "id": 1
    }, 
    {
        "website": "http://www.kfar-saba.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.5, 
                1.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.5, 
                0.5, 
                1.0, 
                0.5, 
                0.0
            ], 
            [
                0.5, 
                0.5, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5
            ], 
            [
                0.5, 
                0.5, 
                0.5, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                0.0
            ]
        ], 
        "name": "כפר סבא", 
        "coordinates": [
            34.907612, 
            32.178194
        ], 
        "id": 5
    }, 
    {
        "website": "http://www.raanana.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.5, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.5, 
                0.5, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.5, 
                1.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.5, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                0.0
            ]
        ], 
        "name": "רעננה", 
        "coordinates": [
            34.871328, 
            32.18478
        ], 
        "id": 10
    }, 
    {
        "website": "http://www.netanya.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                1.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                0.5, 
                0.5
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0
            ], 
            [
                0.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                1.0, 
                1.0, 
                1.0
            ]
        ], 
        "name": "נתניה", 
        "coordinates": [
            34.853197, 
            32.321457
        ], 
        "id": 9
    }, 
    {
        "website": "http://www.beer-sheva.muni.il/openning.asp?Lang=1", 
        "data": [
            [
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                0.5, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                0.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.5, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                1.0, 
                0.0, 
                1.0, 
                0.5, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.5, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                0.0
            ]
        ], 
        "name": "באר שבע", 
        "coordinates": [
            34.791464, 
            31.252972
        ], 
        "id": 8
    }, 
    {
        "website": "http://www.herzliya.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.5, 
                0.5, 
                0.5, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.5, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.5, 
                0.5, 
                0.5
            ], 
            [
                0.5, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.5, 
                0.0, 
                0.5, 
                0.5, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                0.0
            ]
        ], 
        "name": "הרצליה", 
        "coordinates": [
            34.844677, 
            32.162412
        ], 
        "id": 12
    }, 
    {
        "website": "http://www.petah-tikva.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                0.5, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                1.0, 
                0.5, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.5, 
                1.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.5, 
                0.0, 
                0.5, 
                0.0, 
                0.5, 
                0.5
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.5, 
                1.0, 
                0.0
            ]
        ], 
        "name": "פתח תקווה", 
        "coordinates": [
            34.887764, 
            32.08404
        ], 
        "id": 13
    }, 
    {
        "website": "http://www.ramat-gan.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.5, 
                0.5, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.5, 
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                0.5
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                0.5, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.5, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0
            ]
        ], 
        "name": "רמת גן", 
        "coordinates": [
            34.824787, 
            32.068423
        ], 
        "id": 11
    }, 
    {
        "website": "http://www.rehovot.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0, 
                0.5, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.5, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                1.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.0, 
                0.5, 
                1.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                0.0, 
                0.0
            ], 
            [
                1.0, 
                1.0, 
                0.5, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0
            ]
        ], 
        "name": "רחובות", 
        "coordinates": [
            34.811274, 
            31.89277199999999
        ], 
        "id": 15
    }, 
    {
        "website": "http://www.hadera.muni.il/", 
        "data": [
            [
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.5, 
                1.0, 
                1.0, 
                1.0, 
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.5, 
                0.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0
            ], 
            [
                1.0, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                1.0, 
                0.5, 
                0.0
            ], 
            [
                1.0, 
                0.0
            ], 
            [
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0, 
                0.0
            ], 
            [
                0.5, 
                1.0, 
                0.5, 
                1.0, 
                0.5, 
                0.5, 
                1.0
            ], 
            [
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                1.0, 
                1.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                0.0, 
                1.0
            ], 
            [
                1.0, 
                0.0, 
                1.0, 
                0.0
            ]
        ], 
        "name": "חדרה", 
        "coordinates": [
            34.92088, 
            32.442784
        ], 
        "id": 6
    }
]


# This scale is not really colorblind-safe.
scoreColorScale = d3.scale.quantile()
                    .domain([0, 0.5, 0.6, 1])
                    .range(['#DA4F49', '#F89406', '#51A351'])

scoreClassScale = d3.scale.quantile()
                    .domain([0, 0.5, 0.6, 1])
                    .range(['c', 'b', 'a'])


# Bounding box for Israel
israelExtent = new MM.Extent(33.6006300456776,   # north
                             33.9, # west
                             29.223819169667124, # south
                             36.1) # east

# Map Centerpoint for Israel
israelCenter = {lat: 31.637766370126315, lon: 34.99999999999998}

_.templateSettings = {
  interpolate : /\{\{(.+?)\}\}/g
}


$ ->

    class City extends Backbone.Model
        _isInt: (n) ->
            return (typeof(n) == 'number' &&
                    parseFloat(n) == parseInt(n, 10) &&
                    !isNaN(n))

        _sum: (scores) ->
            return _.reduce(scores, (memo, score) ->
                return memo + score)

        _average: (scores) ->
            return @_sum(scores) / scores.length

        _percentify: (score) ->
            return Math.round(score * 100.0)

        categoryScores: (category) ->
            return @get('data')[category]

        categoryAverage: (category) ->
            return @_average(@categoryScores(category))

        categoryAveragePercent: (category) ->
            return @_percentify(@categoryAverage(category))

        total: ->
            return @_sum(@_sum(scores) for scores in @get('data'))

        totalAverage: ->
            return @total() / @totalMax()

        totalAveragePercent: ->
            return @_percentify(@totalAverage())

        totalMax: ->
            return @_sum(_.map(@get('data'), (d) -> return d.length))

        score: (category, criteria) ->
            return @get('data')[category][criteria]

        grade: (category, criteria) ->
            return scoreClassScale(@score(category, criteria)).toUpperCase()

        marker: (category, criteria) ->
            m = {
                geometry: {
                    type: 'Point',
                    coordinates: @get('coordinates'),
                },
                properties: {
                    name: @get('name')
                    id: @id
                    'marker-size': 'medium'
                }
            }

            props = m['properties']
            if @_isInt(criteria) and @_isInt(category)
                props['score'] = @score(category, criteria)
                props['scoreclass'] = scoreClassScale(props['score'])
                props['prettyscore'] = props['scoreclass'].toUpperCase()
                props['description'] = root.guide[category]['fields'][criteria]
                props['marker-color'] = scoreColorScale(props['score'])
                props['marker-symbol'] = scoreClassScale(props['score'])
                props['data-category'] = category
                props['data-criteria'] = criteria

            else if @_isInt(category)
                props['score'] = @categoryAverage(category)
                props['scoreclass'] = scoreClassScale(props['score'])
                props['prettyscore'] = @categoryAveragePercent(category) + '%'
                props['description'] = root.guide[category]['category']
                props['marker-color'] = scoreColorScale(props['score'])
                props['marker-symbol'] = scoreClassScale(props['score'])
                props['data-category'] = category

            else # show overall score
                props['score'] = @totalAverage()
                props['scoreclass'] = scoreClassScale(props['score'])
                props['prettyscore'] = @totalAveragePercent() + '%'
                props['description'] = "ציון כולל"
                props['marker-color'] = scoreColorScale(props['score'])
                props['marker-symbol'] = scoreClassScale(props['score'])
                props['data-category'] = category

            return m


    class Cities extends Backbone.Collection
        model: City


    class MapView extends Backbone.View
        el: $('#map')
        maptooltipTemplate: _.template($('#template_maptooltip').html())

        markerFactory: (m) ->
            elem = mapbox.markers.simplestyle_factory(m)
            MM.addEvent(elem, 'click', (e) =>
                @map.ease.location({
                    lat: m.geometry.coordinates[1],
                    lon: m.geometry.coordinates[0]
                    }).zoom(@map.zoom()).optimal()
                root.App.navigate("city/#{m.properties.id}", {trigger: true})
                $('#content').scrollTo('0%')
            )
            return elem

        initialize: ->
            _.bindAll(@)
            @localizedLayer = mapbox.layer().id('idan.map-468vpvim').composite(false)
            @englishLayer = mapbox.layer().id('idan.map-b25l9lse').composite(false)
            @markerLayer = mapbox.markers.layer().factory(@markerFactory)
            interaction = mapbox.markers.interaction(@markerLayer)
            interaction.formatter((feature) => return @maptooltipTemplate(feature))
            @category = undefined
            @criteria = undefined
            @map = mapbox.map(@el)
            @map.addTileLayer(@localizedLayer)
            @map.addTileLayer(@englishLayer.disable())
            @map.addLayer(@markerLayer)
            @map.ui.zoomer.add()
            @map.setPanLimits(israelExtent)
            @map.setZoomRange(7,12)
            @map.centerzoom(israelCenter, 8)
            @collection.on('all', => @render())
            @render()

        render: ->
            @markerLayer.features(@collection.map((d) =>
                return d.marker(@category, @criteria)))
            $('#maplegend').text(@markerLayer.features()[0].properties.description)
            return @

        setCriteria: (category, criteria) ->
            ###
            Set the criteria used for generating markers.
            Call in one of three forms:
            setCriteria(): resets to the global city average
            setCriteria(category): markers represent the category average
            setCriteria(category, criteria): markers show the specific criteria score
            ###
            @category = category
            @criteria = criteria
            @render()

        localize: (localized) ->
            if localized
                @localizedLayer.enable()
                @englishLayer.disable()
            else
                @englishLayer.enable()
                @localizedLayer.disable()


    class CityListView extends Backbone.View
        tagName: 'section'
        className: 'citylist'
        template: _.template($('#template_citylist').html())

        initialize: ->
            _.bindAll(@)
            @render()

        render: ->
            @$el.html(@template())
            $ul = @$el.children('ul')
            @collection.each((city) =>
                c = new CityListItemView({model: city})
                $ul.append(c.render().el)
            )
            return @


    class CityListItemView extends Backbone.View
        tagName: 'li'
        className: 'citylistitem'
        template: _.template($('#template_citylistitem').html())

        initialize: ->
            _.bindAll(@)
            @render()

        render: ->
            content = @template({
                name: @model.get('name'),
                score: @model.totalAveragePercent(),
                id: @model.id,
            })
            @$el.attr('data-class', scoreClassScale(@model.totalAverage()))
            @$el.html(content)
            return @


    class CityView extends Backbone.View
        tagName: 'section'
        className: 'citydetail'
        cityTemplate: _.template($('#template_citydetail').html())
        categoryTemplate: _.template($('#template_category').html())
        criteriaTemplate: _.template($('#template_criteria').html())

        events: {
          'click .category': 'recolorMap',
          'click .criteria': 'recolorMap',
          'click >header>.score': 'recolorMap',
        }

        initialize: ->
            _.bindAll(@)
            @render()

        render: ->
            # $('#maplegend').text('ציון שקיפות כללי')
            @$el.html(@cityTemplate({
                name: @model.get('name'),
                score: @model.totalAveragePercent(),
                grade: scoreClassScale(@model.totalAverage())
            }))
            for category, i in @model.get('data')
                $cat = $(@categoryTemplate({
                        category: i,
                        name: root.guide[i]['category'],
                        percentage: @model.categoryAveragePercent(i)
                        score: @model.categoryAverage(i)
                        grade: scoreClassScale(@model.categoryAverage(i))
                    }))
                for criteria, j in category
                    crit = @criteriaTemplate({
                        category: i,
                        criteria: j,
                        name: root.guide[i]['fields'][j],
                        grade: @model.grade(i, j)
                        })
                    $cat.children('.criteria-list').append(crit)
                @$el.append($cat)

            return @

        recolorMap: (ev) ->
            source = $(ev.currentTarget)
            description = source.find('header>h1').first().text()
            header = source.children('header')
            triangle = header.children('.triangle')
            category = parseInt(source.attr('data-category') or -1)
            criteria = parseInt(source.attr('data-criteria') or -1)
            $('.selected').removeClass('selected')
            triangle.css('top', (header.height() / 2 - 10) + 'px')

            if (category >= 0 and criteria >=0)
                mapView.setCriteria(category, criteria)
                source.addClass('selected')
            else if (category >= 0)
                mapView.setCriteria(category)
                if source.children('.criteria-list').hasClass('collapsed')
                    source.children('.criteria-list').removeClass('collapsed')
                    $('#content').scrollTo(source, 250, {offset: -20})
                else
                    source.children('.criteria-list').addClass('collapsed')
                    $('#content').scrollTo(source, 250, {offset: -20})
                source.addClass('selected')
            else
                mapView.setCriteria()
            return false


    cities = new Cities()
    cities.reset(data)
    root.cities = cities

    class TransparencyMap extends Backbone.Router
        routes: {
            '': 'home',
            'city/:id': 'city'
        }

        initialize: ->
            @cityListView = new CityListView({collection: cities})
            @mapView = new MapView({collection: cities})
            root.mapView = @mapView

        home: ->
            $('#info').empty()
            $('#info').html(@cityListView.render().el)
            @mapView.setCriteria()

        city: (id) ->
            $('#info').empty()
            @mapView.setCriteria()
            cv = new CityView({model: cities.get(id)})
            $('#info').html(cv.render().el)



    root.App = new TransparencyMap()
    Backbone.history.start()
